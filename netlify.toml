[build]
  # Disattivo completamente qualsiasi processo di build
  # e pubblico direttamente l'HTML statico
  base = "New1-master"
  command = "npm install -g pnpm && pnpm install && cd apps/platform && pnpm build"
  publish = "New1-master/apps/platform/dist"

[build.environment]
  NODE_VERSION = "18"
  PNPM_VERSION = "8.6.12"
  NPM_FLAGS = "--no-frozen-lockfile"
  NETLIFY_USE_PNPM = "true"

[[headers]]
  for = "/*"
  [headers.values]
    # Permetti le richieste cross-origin per le API wallet
    Access-Control-Allow-Origin = "*"
    Access-Control-Allow-Methods = "GET, POST, OPTIONS"
    Access-Control-Allow-Headers = "Origin, X-Requested-With, Content-Type, Accept"
    # Abilita tutte le funzionalit√† necessarie
    Feature-Policy = "camera 'none'; microphone 'none'; payment 'self'"
    Referrer-Policy = "no-referrer-when-downgrade"
    X-Content-Type-Options = "nosniff"
    # Permetti il caricamento di worker e script esterni
    Content-Security-Policy = "default-src 'self' https: wss: blob: data: 'unsafe-inline' 'unsafe-eval'"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200 